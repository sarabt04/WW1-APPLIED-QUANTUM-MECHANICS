###################  A NAIVE MODEL FOR 2-ELECTRON ATOMS  ######################
import numpy as np
import matplotlib.pyplot as plt
from scipy.linalg import eigh

# 1. DISCRETITZATION  ---------------------------------------------------------
R=50
N=2000
delta_r=R/N
r=np.linspace(delta_r,R+delta_r,N)

# 2. BUILD THE MATRICES  ------------------------------------------------------
#Kinetic energy
K_old=np.zeros((N, N))
for i in range(0, N):
    if i > 0:
        K_old[i,i-1]=1
        
    K_old[i, i]=-2
    
    if i < N-1:
        K_old[i,i+1]=1

K=-1/(2*delta_r**2)*K_old


#Effective potential
def Veff(r, Z, l):
    return -(Z)/r+1/r-((Z-5/16)+1/(r))*np.exp(-2*(Z-5/16)*r)+l*(l+1)/(r**2)

V1=np.zeros((N,N))
for i in range(0,N):
    V1[i, i]=Veff(r[i],Z=2,l=0)

V2=np.zeros((N,N))
for i in range(0,N):
    V2[i, i]=Veff(r[i],Z=2,l=1)
    
  
    
#Final matrix
A1=K+V1
A2=K+V2

# 3. SOLUTION THE EIGENVALUES PROBLEM  ----------------------------------------
#E, u = np.linalg.eigh(A)
Es, u1 = eigh(A1)
Ep, u2 = eigh(A2)
#print("First energies:", Es[:10])
print("Energies:")
print("1s:", Es[0])
print("2s:", Es[1])
print("2p:", Ep[0])
